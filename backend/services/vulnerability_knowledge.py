"""
База знаний об уязвимостях с понятными объяснениями и видео
"""

class VulnerabilityKnowledge:
    """База знаний об уязвимостях"""
    
    VULNERABILITIES = {
        'sql_injection': {
            'name_ru': 'SQL Инъекция',
            'name_de': 'SQL Injection',
            'severity': 'CRITICAL',
            
            # Простое объяснение
            'explanation_ru': '''
                **Что это значит:**
                Злоумышленник может обойти проверку логина и получить доступ к базе данных вашего сайта.
                
                **Что может украсть хакер:**
                • Все данные клиентов (имена, адреса, телефоны, email)
                • Пароли пользователей
                • Данные заказов и платежей
                • Содержимое всей базы данных
                
                **Последствия для вашего бизнеса:**
                • Штрафы по GDPR до €20 миллионов или 4% от оборота
                • Судебные иски от пострадавших клиентов
                • Потеря репутации и доверия клиентов
                • Блокировка сайта регулятором
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Ein Angreifer kann die Login-Prüfung umgehen und Zugriff auf Ihre Website-Datenbank erhalten.
                
                **Was kann ein Hacker stehlen:**
                • Alle Kundendaten (Namen, Adressen, Telefonnummern, E-Mails)
                • Benutzerpasswörter
                • Bestell- und Zahlungsdaten
                • Gesamter Datenbankinhalt
                
                **Folgen für Ihr Geschäft:**
                • DSGVO-Strafen bis zu €20 Millionen oder 4% des Umsatzes
                • Klagen von betroffenen Kunden
                • Verlust von Reputation und Kundenvertrauen
                • Sperrung der Website durch Regulierungsbehörden
            ''',
            
            # Примерная стоимость ущерба
            'damage_cost_min': 50000,
            'damage_cost_max': 500000,
            'currency': 'EUR',
            
            # Видео демонстрация
            'video': {
                'youtube_id': 'ciNHn38EyRc',  # Пример: SQL Injection Explained
                'title_ru': 'Видео: Как работает SQL Injection (2 минуты)',
                'title_de': 'Video: Wie SQL Injection funktioniert (2 Minuten)',
                'duration': '2:15',
                'thumbnail': 'https://img.youtube.com/vi/ciNHn38EyRc/mqdefault.jpg'
            },
            
            # Рекомендация по защите
            'solution_ru': '''
                **Как защититься:**
                • Использовать подготовленные запросы (Prepared Statements)
                • Валидация всех пользовательских данных
                • Использовать ORM (Doctrine, Eloquent)
                • Ограничение прав доступа к базе данных
                • Регулярный аудит кода
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Prepared Statements verwenden
                • Validierung aller Benutzerdaten
                • ORM verwenden (Doctrine, Eloquent)
                • Datenbankzugriffsrechte einschränken
                • Regelmäßige Code-Audits
            ''',
            
            # Для верифицированных владельцев
            'test_payload': "admin' OR '1'='1' --",
            'test_instruction_ru': '''
                **Проверьте сами (только для владельцев сайта):**
                1. Откройте форму входа на вашем сайте
                2. В поле "Email/Логин" введите: admin' OR '1'='1' --
                3. В поле "Пароль" введите любой текст
                4. Нажмите "Войти"
                
                ⚠️ Если вы вошли без правильного пароля - ваш сайт УЯЗВИМ!
            ''',
            
            'test_instruction_de': '''
                **Selbst testen (nur für Websitebesitzer):**
                1. Öffnen Sie das Login-Formular Ihrer Website
                2. Geben Sie im Feld "E-Mail/Login" ein: admin' OR '1'='1' --
                3. Geben Sie im Feld "Passwort" einen beliebigen Text ein
                4. Klicken Sie auf "Anmelden"
                
                ⚠️ Wenn Sie ohne richtiges Passwort eingeloggt wurden - Ihre Website ist VERWUNDBAR!
            '''
        },
        
        'xss': {
            'name_ru': 'XSS (Межсайтовый скриптинг)',
            'name_de': 'XSS (Cross-Site Scripting)',
            'severity': 'HIGH',
            
            'explanation_ru': '''
                **Что это значит:**
                Злоумышленник может внедрить вредоносный код на ваш сайт, который выполнится в браузере ваших клиентов.
                
                **Что может сделать хакер:**
                • Украсть сессии пользователей (получить доступ к их аккаунтам)
                • Перенаправить пользователей на фишинговые сайты
                • Украсть cookies и токены авторизации
                • Изменить содержимое страницы для отдельных пользователей
                • Установить вредоносное ПО через браузер
                
                **Последствия:**
                • Кража аккаунтов клиентов
                • Репутационный ущерб: от €20,000
                • Потеря доверия пользователей
                • Блокировка сайта антивирусами
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Ein Angreifer kann schädlichen Code auf Ihrer Website einschleusen, der im Browser Ihrer Kunden ausgeführt wird.
                
                **Was kann ein Hacker tun:**
                • Benutzersitzungen stehlen (Zugriff auf ihre Konten erhalten)
                • Benutzer auf Phishing-Websites umleiten
                • Cookies und Autorisierungstoken stehlen
                • Seiteninhalte für einzelne Benutzer ändern
                • Malware über den Browser installieren
                
                **Folgen:**
                • Diebstahl von Kundenkonten
                • Reputationsschaden: ab €20.000
                • Verlust des Benutzervertrauens
                • Sperrung der Website durch Antiviren-Software
            ''',
            
            'damage_cost_min': 20000,
            'damage_cost_max': 200000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': 'EoaDgUgS6QA',  # Пример: XSS Explained
                'title_ru': 'Видео: Как работает XSS атака (3 минуты)',
                'title_de': 'Video: Wie XSS-Angriffe funktionieren (3 Minuten)',
                'duration': '3:20',
                'thumbnail': 'https://img.youtube.com/vi/EoaDgUgS6QA/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Экранирование всех пользовательских данных при выводе
                • Content Security Policy (CSP) заголовки
                • Использовать HttpOnly флаг для cookies
                • Валидация и санитизация входных данных
                • Использовать современные фреймворки с встроенной защитой
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Alle Benutzerdaten bei der Ausgabe escapen
                • Content Security Policy (CSP) Header
                • HttpOnly-Flag für Cookies verwenden
                • Eingabedaten validieren und bereinigen
                • Moderne Frameworks mit integriertem Schutz verwenden
            ''',
            
            'test_payload': '<script>alert("XSS")</script>',
            'test_instruction_ru': '''
                **Проверьте сами:**
                1. Найдите форму комментариев или отзывов на вашем сайте
                2. Вставьте код: <script>alert("XSS")</script>
                3. Отправьте форму
                4. Обновите страницу
                
                ⚠️ Если появилось всплывающее окно "XSS" - сайт УЯЗВИМ!
            ''',
            
            'test_instruction_de': '''
                **Selbst testen:**
                1. Finden Sie ein Kommentar- oder Bewertungsformular auf Ihrer Website
                2. Fügen Sie den Code ein: <script>alert("XSS")</script>
                3. Senden Sie das Formular
                4. Aktualisieren Sie die Seite
                
                ⚠️ Wenn ein Popup-Fenster "XSS" erscheint - Ihre Website ist VERWUNDBAR!
            '''
        },
        
        'csrf': {
            'name_ru': 'CSRF (Подделка межсайтовых запросов)',
            'name_de': 'CSRF (Cross-Site Request Forgery)',
            'severity': 'MEDIUM',
            
            'explanation_ru': '''
                **Что это значит:**
                Хакер может выполнить действия от имени залогиненного пользователя без его ведома.
                
                **Что может сделать хакер:**
                • Изменить пароль пользователя
                • Сделать покупки от имени клиента
                • Изменить настройки аккаунта
                • Удалить данные пользователя
                • Выполнить банковский перевод (для платёжных систем)
                
                **Последствия:**
                • Несанкционированные операции
                • Финансовый ущерб клиентам: от €10,000
                • Судебные иски
                • Потеря репутации
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Ein Hacker kann Aktionen im Namen eines eingeloggten Benutzers ohne dessen Wissen ausführen.
                
                **Was kann ein Hacker tun:**
                • Benutzerpasswort ändern
                • Einkäufe im Namen des Kunden tätigen
                • Kontoeinstellungen ändern
                • Benutzerdaten löschen
                • Banküberweisungen durchführen (für Zahlungssysteme)
                
                **Folgen:**
                • Unautorisierte Operationen
                • Finanzieller Schaden für Kunden: ab €10.000
                • Gerichtsprozesse
                • Reputationsverlust
            ''',
            
            'damage_cost_min': 10000,
            'damage_cost_max': 100000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': 'vRBihr41JTo',  # Пример: CSRF Explained
                'title_ru': 'Видео: Как работает CSRF атака (2 минуты)',
                'title_de': 'Video: Wie CSRF-Angriffe funktionieren (2 Minuten)',
                'duration': '2:45',
                'thumbnail': 'https://img.youtube.com/vi/vRBihr41JTo/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • CSRF токены для всех форм
                • SameSite Cookie атрибут
                • Проверка Referer заголовка
                • Double Submit Cookie паттерн
                • Использовать POST вместо GET для изменений
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • CSRF-Token für alle Formulare
                • SameSite Cookie-Attribut
                • Referer-Header-Prüfung
                • Double Submit Cookie-Muster
                • POST statt GET für Änderungen verwenden
            '''
        },
        
        'missing_ssl': {
            'name_ru': 'Отсутствие SSL/TLS шифрования',
            'name_de': 'Fehlendes SSL/TLS Verschlüsselung',
            'severity': 'HIGH',
            
            'explanation_ru': '''
                **Что это значит:**
                Данные между пользователем и сервером передаются в открытом виде.
                
                **Что может перехватить хакер:**
                • Логины и пароли пользователей
                • Данные кредитных карт
                • Личную переписку
                • Токены авторизации
                • Любую другую информацию
                
                **Последствия:**
                • Штрафы за отсутствие шифрования: от €5,000
                • Браузеры помечают сайт как "небезопасный"
                • Google понижает в поисковой выдаче
                • Потеря клиентов (80% не доверяют сайтам без SSL)
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Daten zwischen Benutzer und Server werden unverschlüsselt übertragen.
                
                **Was kann ein Hacker abfangen:**
                • Benutzer-Logins und Passwörter
                • Kreditkartendaten
                • Persönliche Korrespondenz
                • Autorisierungstoken
                • Alle anderen Informationen
                
                **Folgen:**
                • Bußgelder für fehlende Verschlüsselung: ab €5.000
                • Browser markieren Website als "unsicher"
                • Google stuft in Suchergebnissen herab
                • Kundenverlust (80% vertrauen Websites ohne SSL nicht)
            ''',
            
            'damage_cost_min': 5000,
            'damage_cost_max': 50000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': 'T4Df5_cojAs',  # Пример: SSL/TLS Explained
                'title_ru': 'Видео: Зачем нужен SSL сертификат (3 минуты)',
                'title_de': 'Video: Warum SSL-Zertifikat notwendig ist (3 Minuten)',
                'duration': '3:10',
                'thumbnail': 'https://img.youtube.com/vi/T4Df5_cojAs/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Установить бесплатный SSL сертификат Let's Encrypt
                • Настроить автоматическое перенаправление HTTP → HTTPS
                • Включить HSTS заголовок
                • Использовать TLS 1.2 или выше
                • Обновлять сертификат каждые 90 дней
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Kostenloses SSL-Zertifikat Let's Encrypt installieren
                • Automatische Weiterleitung HTTP → HTTPS einrichten
                • HSTS-Header aktivieren
                • TLS 1.2 oder höher verwenden
                • Zertifikat alle 90 Tage erneuern
            '''
        },
        
        'weak_password_policy': {
            'name_ru': 'Слабая политика паролей',
            'name_de': 'Schwache Passwort-Richtlinie',
            'severity': 'MEDIUM',
            
            'explanation_ru': '''
                **Что это значит:**
                Система позволяет пользователям создавать слабые пароли, которые легко взломать.
                
                **Что может сделать хакер:**
                • Подобрать пароли методом перебора
                • Использовать словарные атаки
                • Получить доступ к аккаунтам
                • Украсть данные клиентов
                
                **Последствия:**
                • Массовый взлом аккаунтов
                • Ущерб от €15,000
                • Потеря доверия клиентов
                • Штрафы за недостаточную защиту данных
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Das System erlaubt Benutzern, schwache Passwörter zu erstellen, die leicht zu knacken sind.
                
                **Was kann ein Hacker tun:**
                • Passwörter durch Brute-Force erraten
                • Wörterbuch-Angriffe verwenden
                • Zugriff auf Konten erhalten
                • Kundendaten stehlen
                
                **Folgen:**
                • Massenhafte Kontohacks
                • Schaden ab €15.000
                • Verlust des Kundenvertrauens
                • Bußgelder für unzureichenden Datenschutz
            ''',
            
            'damage_cost_min': 15000,
            'damage_cost_max': 150000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': '7U-RbOKanYs',  # Пример: Password Security
                'title_ru': 'Видео: Почему важны надежные пароли (2 минуты)',
                'title_de': 'Video: Warum starke Passwörter wichtig sind (2 Minuten)',
                'duration': '2:30',
                'thumbnail': 'https://img.youtube.com/vi/7U-RbOKanYs/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Минимум 8 символов для паролей
                • Требовать буквы, цифры и спецсимволы
                • Проверка на популярные пароли (123456, password)
                • Двухфакторная аутентификация
                • Ограничение попыток входа
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Mindestens 8 Zeichen für Passwörter
                • Buchstaben, Zahlen und Sonderzeichen erforderlich
                • Prüfung auf häufige Passwörter (123456, password)
                • Zwei-Faktor-Authentifizierung
                • Begrenzung der Anmeldeversuche
            '''
        },
        
        'missing_hsts': {
            'name_ru': 'Отсутствует HSTS (HTTP Strict Transport Security)',
            'name_de': 'Fehlendes HSTS (HTTP Strict Transport Security)',
            'severity': 'MEDIUM',
            
            'explanation_ru': '''
                **Что это значит:**
                Ваш сайт не заставляет браузеры использовать только защищённое HTTPS соединение.
                Хакер может перехватить данные пользователя через незащищённый HTTP.
                
                **Что может украсть хакер:**
                • Пароли при входе на сайт
                • Cookies и токены сессии
                • Платёжные данные
                • Переписку и личную информацию
                
                **Как это работает:**
                Атака "Man-in-the-Middle" - хакер встаёт между пользователем и сайтом в публичном WiFi.
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Ihre Website zwingt Browser nicht, nur sichere HTTPS-Verbindungen zu verwenden.
                Ein Hacker kann Benutzerdaten über ungesichertes HTTP abfangen.
                
                **Was kann ein Hacker stehlen:**
                • Passwörter beim Login
                • Cookies und Session-Tokens
                • Zahlungsdaten
                • Korrespondenz und persönliche Informationen
                
                **Wie funktioniert es:**
                "Man-in-the-Middle"-Angriff - Hacker positioniert sich zwischen Benutzer und Website in öffentlichem WiFi.
            ''',
            
            'damage_cost_min': 5000,
            'damage_cost_max': 50000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': '_BNIkw4Ao9w',
                'title_ru': 'Видео: Зачем нужен HSTS (3 минуты)',
                'title_de': 'Video: Warum HSTS wichtig ist (3 Minuten)',
                'duration': '3:20',
                'thumbnail': 'https://img.youtube.com/vi/_BNIkw4Ao9w/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Добавить заголовок: Strict-Transport-Security: max-age=31536000; includeSubDomains
                • Включить HSTS Preload для максимальной защиты
                • Убедиться что весь сайт работает на HTTPS
                • Проверить на https://hstspreload.org/
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Header hinzufügen: Strict-Transport-Security: max-age=31536000; includeSubDomains
                • HSTS Preload für maximalen Schutz aktivieren
                • Sicherstellen, dass die gesamte Website auf HTTPS läuft
                • Überprüfen auf https://hstspreload.org/
            '''
        },
        
        'clickjacking': {
            'name_ru': 'Clickjacking (отсутствует X-Frame-Options)',
            'name_de': 'Clickjacking (fehlendes X-Frame-Options)',
            'severity': 'MEDIUM',
            
            'explanation_ru': '''
                **Что это значит:**
                Хакер может встроить ваш сайт в невидимый iframe на фишинговой странице.
                Пользователь думает что кликает на кнопку "Скачать котиков", а на самом деле переводит деньги!
                
                **Что может сделать хакер:**
                • Украсть клики на кнопки "Оплатить", "Перевести"
                • Заставить пользователя подписаться на платные услуги
                • Изменить настройки аккаунта
                • Получить доступ к камере/микрофону через браузер
                
                **Реальный пример:**
                Facebook потерял $500,000 из-за Clickjacking атаки на кнопку "Like".
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Ein Hacker kann Ihre Website in einen unsichtbaren iframe auf einer Phishing-Seite einbetten.
                Der Benutzer denkt, er klickt auf "Katzen herunterladen", überweist aber tatsächlich Geld!
                
                **Was kann ein Hacker tun:**
                • Klicks auf "Bezahlen", "Überweisen"-Buttons stehlen
                • Benutzer zu kostenpflichtigen Diensten zwingen
                • Kontoeinstellungen ändern
                • Zugriff auf Kamera/Mikrofon über Browser erhalten
                
                **Reales Beispiel:**
                Facebook verlor $500,000 durch Clickjacking-Angriff auf "Like"-Button.
            ''',
            
            'damage_cost_min': 10000,
            'damage_cost_max': 100000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': 'jcp5t8PsMsY',
                'title_ru': 'Видео: Демонстрация Clickjacking атаки (4 минуты)',
                'title_de': 'Video: Clickjacking-Angriff Demo (4 Minuten)',
                'duration': '4:15',
                'thumbnail': 'https://img.youtube.com/vi/jcp5t8PsMsY/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Добавить заголовок: X-Frame-Options: DENY
                • Или: X-Frame-Options: SAMEORIGIN (если нужны iframe на своём сайте)
                • Добавить в CSP: frame-ancestors 'none'
                • Проверить что сайт не открывается в iframe
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Header hinzufügen: X-Frame-Options: DENY
                • Oder: X-Frame-Options: SAMEORIGIN (wenn iframes auf eigener Website benötigt)
                • In CSP hinzufügen: frame-ancestors 'none'
                • Überprüfen, dass die Website nicht in iframe geöffnet wird
            '''
        },
        
        'mime_sniffing': {
            'name_ru': 'MIME Sniffing (отсутствует X-Content-Type-Options)',
            'name_de': 'MIME Sniffing (fehlendes X-Content-Type-Options)',
            'severity': 'MEDIUM',
            
            'explanation_ru': '''
                **Что это значит:**
                Браузер может "угадать" тип файла неправильно и выполнить вредоносный код.
                Хакер загружает картинку.jpg, а браузер выполняет её как JavaScript!
                
                **Что может сделать хакер:**
                • Выполнить вредоносный JavaScript код
                • Украсть cookies и токены пользователя
                • Перенаправить на фишинговый сайт
                • Заразить компьютер пользователя
                
                **Как это работает:**
                Загружаете "безобидную картинку", а внутри спрятан JavaScript.
                Браузер видит код и запускает его.
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Browser kann Dateityp falsch "erraten" und schädlichen Code ausführen.
                Hacker lädt bild.jpg hoch, aber Browser führt es als JavaScript aus!
                
                **Was kann ein Hacker tun:**
                • Schädlichen JavaScript-Code ausführen
                • Cookies und Tokens des Benutzers stehlen
                • Auf Phishing-Website umleiten
                • Computer des Benutzers infizieren
                
                **Wie funktioniert es:**
                Sie laden "harmloses Bild" hoch, aber JavaScript ist darin versteckt.
                Browser sieht Code und führt ihn aus.
            ''',
            
            'damage_cost_min': 5000,
            'damage_cost_max': 40000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': '8bhYoERA0I4',
                'title_ru': 'Видео: Атака через MIME Type (3 минуты)',
                'title_de': 'Video: MIME-Type-Angriff (3 Minuten)',
                'duration': '3:10',
                'thumbnail': 'https://img.youtube.com/vi/8bhYoERA0I4/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Добавить заголовок: X-Content-Type-Options: nosniff
                • Указывать правильный Content-Type для всех файлов
                • Валидировать загружаемые файлы по содержимому
                • Хранить загрузки пользователей отдельно от кода сайта
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Header hinzufügen: X-Content-Type-Options: nosniff
                • Korrekten Content-Type für alle Dateien angeben
                • Hochgeladene Dateien nach Inhalt validieren
                • Benutzer-Uploads getrennt vom Website-Code speichern
            '''
        },
        
        'info_disclosure': {
            'name_ru': 'Раскрытие информации о сервере',
            'name_de': 'Server-Informationsoffenlegung',
            'severity': 'LOW',
            
            'explanation_ru': '''
                **Что это значит:**
                Ваш сайт сообщает хакерам какой сервер и версию ПО вы используете.
                Это как оставить инструкцию "как меня взломать" на входной двери.
                
                **Что видит хакер:**
                • Версию веб-сервера (Apache 2.4.41, nginx 1.18)
                • Версию PHP (PHP/7.4.3)
                • Используемые технологии
                • Известные уязвимости этих версий
                
                **Чем это опасно:**
                Хакер знает точно какие эксплойты использовать.
                Вместо перебора, атака занимает минуты.
            ''',
            
            'explanation_de': '''
                **Was bedeutet das:**
                Ihre Website teilt Hackern mit, welchen Server und welche Software-Version Sie verwenden.
                Das ist wie eine "Anleitung zum Hacken" an der Eingangstür zu hinterlassen.
                
                **Was sieht ein Hacker:**
                • Webserver-Version (Apache 2.4.41, nginx 1.18)
                • PHP-Version (PHP/7.4.3)
                • Verwendete Technologien
                • Bekannte Schwachstellen dieser Versionen
                
                **Warum ist das gefährlich:**
                Hacker weiß genau, welche Exploits zu verwenden sind.
                Statt Ausprobieren dauert Angriff nur Minuten.
            ''',
            
            'damage_cost_min': 1000,
            'damage_cost_max': 10000,
            'currency': 'EUR',
            
            'video': {
                'youtube_id': 'nkGiFGDySOU',
                'title_ru': 'Видео: Почему нельзя раскрывать версии (2 минуты)',
                'title_de': 'Video: Warum Versionen nicht offenlegen (2 Minuten)',
                'duration': '2:30',
                'thumbnail': 'https://img.youtube.com/vi/nkGiFGDySOU/mqdefault.jpg'
            },
            
            'solution_ru': '''
                **Как защититься:**
                • Скрыть заголовок Server или изменить его значение
                • Убрать версию PHP из заголовков (expose_php = Off)
                • Отключить подписи сервера (ServerTokens Prod)
                • Скрыть X-Powered-By заголовок
                • Использовать WAF для маскировки сервера
            ''',
            
            'solution_de': '''
                **Wie man sich schützt:**
                • Server-Header verbergen oder Wert ändern
                • PHP-Version aus Headern entfernen (expose_php = Off)
                • Server-Signaturen deaktivieren (ServerTokens Prod)
                • X-Powered-By-Header verbergen
                • WAF zur Server-Maskierung verwenden
            '''
        }
    }
    
    @classmethod
    def get_vulnerability_info(cls, vulnerability_type: str, language: str = 'de', verified: bool = False) -> dict:
        """
        Получить информацию об уязвимости
        
        Args:
            vulnerability_type: Тип уязвимости
            language: Язык ('ru' или 'de')
            verified: Верифицирован ли пользователь (для показа test инструкций)
            
        Returns:
            dict: Информация об уязвимости
        """
        vuln = cls.VULNERABILITIES.get(vulnerability_type, {})
        
        if not vuln:
            return None
        
        result = {
            'type': vulnerability_type,
            'name': vuln.get(f'name_{language}', vuln.get('name_ru')),
            'severity': vuln.get('severity'),
            'explanation': vuln.get(f'explanation_{language}', vuln.get('explanation_ru')),
            'solution': vuln.get(f'solution_{language}', vuln.get('solution_ru')),
            'damage_cost': {
                'min': vuln.get('damage_cost_min'),
                'max': vuln.get('damage_cost_max'),
                'currency': vuln.get('currency', 'EUR')
            },
            'video': vuln.get('video', {})
        }
        
        # Добавляем инструкции по тестированию только для верифицированных
        if verified:
            result['test_payload'] = vuln.get('test_payload')
            result['test_instruction'] = vuln.get(f'test_instruction_{language}', vuln.get('test_instruction_ru'))
        
        return result
    
    @classmethod
    def get_all_vulnerabilities(cls, language: str = 'ru') -> list:
        """Получить список всех уязвимостей"""
        return [
            {
                'type': vuln_type,
                'name': vuln.get(f'name_{language}', vuln.get('name_ru')),
                'severity': vuln.get('severity')
            }
            for vuln_type, vuln in cls.VULNERABILITIES.items()
        ]
